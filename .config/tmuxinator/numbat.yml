name: numbat

pre_window:
  - nvm use 8.11.4
  - rvm use 2.2
  - <%= @args.include?('local') && 'export LOCAL_DB=true' %>
  - >
    upload() {
      export OLD_PWD=$(pwd)
      cd ~/Documents/numbat-server
      export GIT_HASH=$(git rev-parse --verify --quiet HEAD | cut -c1-9)
      export FILE_NAME="numbat-server-HEAD-mri-${GIT_HASH}.zip"
      scp releases/$FILE_NAME deploy@10.181.196.23:$FILE_NAME

      cd ~/Documents/numbat-webapp
      export GIT_HASH=$(git rev-parse --verify --quiet HEAD | cut -c1-7)
      export FILE_NAME="numbat-webapp-HEAD-${GIT_HASH}.zip"
      scp releases/$FILE_NAME deploy@10.181.196.23:$FILE_NAME

      cd $OLD_PWD
    }
  - clear
windows:
  - frontend:
      root: ~/Documents/numbat-webapp/dashboard
      layout: 'b697,166x53,0,0[166x45,0,0,2,166x7,0,46{80x7,0,46,7,28x7,81,46,8,28x7,110,46,9,27x7,139,46,10}]'
      panes:
       - vim
       -
       -
         - cd ..
         - ember serve
       - yarn dev
       - yarn storybook

  - backend:
      root: ~/Documents/numbat-server
      layout: 'b697,166x53,0,0[166x45,0,0,2,166x7,0,46{80x7,0,46,7,28x7,81,46,8,28x7,110,46,9,27x7,139,46,10}]'
      panes:
        - vim
        -
        -
          - docker start mssql
          - docker logs -f mssql
        - rs
        - vpn:
          - cd ~/Vpns
          - sudo openvpn RACKSPACE_RLOVE.ovpn
